%% lds_ldpc_gf2_2000_4000 c代码,迭代10次
c_gf2_ber=[0.0675 0.02658 0.002755 ];
%% lds_ldpc_gf2_2000_4000 c代码,迭代50次
ber=[5.7e-2 3.24e-2 1.27e-2 2.92e-3 3.53e-4 3.38e-5];
fer=[7.56e-1 4.762e-1 2.113e-1 5.469e-2 7.5e-3 7.658e-4];
0.5:0.2:1.5
%% lds_ldpc_gf16_500_1000 c代码，迭代50次
[3.19e-2 1.65e-2 7.48e-3 2.79e-3 9.71e-4 3.11e-4 5.54e-5 2.13e-5 9.89e-6 3.59e-6]
0.5:0.2:2.3
%% start %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% start
% lds_ldpc_gf16_500_1000 bp，迭代50次
ber=[2.057e-2 1.365e-2 8.807e-3 5.716e-3 2.271e-3 8.628e-4 2.882e-4 1.004e-4 2.6e-5];
fer=[5.284e-1 3.977e-1 2.443e-1 2.102e-1 1.250e-1 5.030e-2 2.061e-2 9.885e-3 4.5e-3 ];
snr=0.5:0.1:1.3;
% lds_ldpc_gf16_500_1000 bp，迭代10次
ber=[6.15e-2 5.35e-2 4.58e-2 3.84e-2 3.12e-2 2.50e-2 1.95e-2 1.50e-2 1.12e-2 8.07e-3 5.61e-3 3.73e-3 2.53e-3 1.49e-3 8.55e-4 4.66e-4 2.65e-4];
fer=[1 1 1 1 1 9.88e-1 9.72e-1 9.26e-1 8.52e-1 8.01e-1 7.16e-1 6.25e-1 5.00e-1 3.75e-1 3.01e-1 2.05e-1 1.18e-1];
snr=0.2:0.1:1.8;
% lds_ldpc_gf64  bp,迭代50次
ber=[2.939e-2 1.602e-2 1.06e-2 5.73e-3 2.759e-3 1.131e-3 2.202e-4];
fer=[3.864e-1 2.330e-1 1.29e-1 8.33e-2 4.613e-2 1.523e-2 7.282e-3];
snr=0.2:0.1:0.8;
% lds_ldpc_gf64  bp,迭代10次

% plot
semilogy(0.5:0.1:1.3,[2.057e-2 1.365e-2 8.807e-3 5.716e-3 2.271e-3 8.628e-4 2.882e-4 1.004e-4 2.6e-5],'r-.');
hold on;
semilogy(0.5:0.1:1.3,[5.284e-1 3.977e-1 2.443e-1 2.102e-1 1.250e-1 5.030e-2 2.061e-2 9.885e-3 4.5e-3 ],'g-.');
grid on;
xlabel('EsNo(dB)');ylabel('BER/FER');title('gf(q)-ldpc(r=1/2)-LDS-CDMA(1216),等效比特码长4000');

semilogy(0.2:0.1:1.8,[6.15e-2 5.35e-2 4.58e-2 3.84e-2 3.12e-2 2.50e-2 1.95e-2 1.50e-2 1.12e-2 8.07e-3 5.61e-3 3.73e-3 2.53e-3 1.49e-3 8.55e-4 4.66e-4 2.65e-4],'r*-');
semilogy(0.2:0.1:1.8,[1 1 1 1 1 9.88e-1 9.72e-1 9.26e-1 8.52e-1 8.01e-1 7.16e-1 6.25e-1 5.00e-1 3.75e-1 3.01e-1 2.05e-1 1.18e-1],'g*-');

semilogy(0.2:0.1:0.8,[2.939e-2 1.602e-2 1.06e-2 5.73e-3 2.759e-3 1.131e-3 2.202e-4],'r');
semilogy(0.2:0.1:0.8,[3.864e-1 2.330e-1 1.29e-1 8.33e-2 4.613e-2 1.523e-2 7.282e-3],'g');

semilogy(0.5:0.2:1.5,[5.7e-2 3.24e-2 1.27e-2 2.92e-3 3.53e-4 3.38e-5],'ro-');
semilogy(0.5:0.2:1.5,[7.56e-1 4.762e-1 2.113e-1 5.469e-2 7.5e-3 7.658e-4],'go-');
legend('gf16,ite=50,ber','gf16,ite=50,fer','gf16,ite=10,ber','gf16,ite=10,fer','gf64,ite=50,ber','gf64,ite=50,fer','gf2,ite=50,ber','gf2,ite=50,fer','Location','southwest');
hold off;
%% end %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% end
%% lds_ldpc_gf16_2026_4052 c代码，迭代20次
c_gf16_ber=[3.58e-2 8.807e-3 1.226e-3 1.465e-4];
snr=0.5:0.5:2;

%% lds_ldpc_gf2_972_1944 matlab代码 迭代50次，自动终止
m_gf2_ber=[0.0179    0.0077    0.0017    0.0003];
%% lds_ldpc_gf2_2000_4000 matlab代码 迭代50次，自动终止
m_gf2_ber_1=[0.0593    0.0355    0.0123    0.0035    0.0003 1.7456e-05];
m_gf2_fer_1=[0.7813    0.5208    0.2054    0.0568    0.0069 3.8965e-04];
snr=0.5:0.2:1.5;


%% ldpc_gf16_2026_4052 c代码 maxIte=20
c_ldpc_gf16_ber=[1.28e-1 8.3436e-2 3.5283e-2 ];
c_ldpc_gf16_snr=[0 0.5 1 ];
%% ldpc_gf16_500_1000 c代码 maxIte=50
c_ldpc_gf16_ber_1=[1.31e-1 1.16e-1 9.87e-2 7.58e-2 5.58e-2 3.40e-2 1.64e-2 6.55e-3 2.05e-3 8.66e-4 3.71e-4 1.49e-4 5.45e-5 3.96e-5 4.95e-6];
c_ldpc_gf16_snr_1=0:0.2:2.8;
%% ldpc_gf2_2000_4000 matlab代码
m_ldpc_gf2_ber=[0.1307    0.1191    0.1056    0.0975    0.0828    0.0698    0.0321    0.0044    0.0004];
snr=-3:0.2:-1.4;

%% nb_ldpc 不同算法性能比较,  ldpc_gf16_500_1000 maxIte=50
% define BP_DECODE 1
ber=[1.13e-1 9.93e-2 8.31e-2 5.95e-2 3.9e-2 1.48e-2 5.62e-3 6.86e-4 1.57e-4];
snr=0:0.2:1.6;
% define EMS_DECODE 2
snr=0:0.2:2;
ber=[1.24e-1 1.08e-1 9.02e-2 7.12e-2 4.81e-2 2.75e-2 1.07e-2 3.52e-3 8.53e-4 2.65e-4 7.84e-5];
% define MinMax_DECODE 3 (不支持)
% define T_EMS_DECODE 4
ber=[1.31e-1 1.16e-1 9.87e-2 7.58e-2 5.58e-2 3.40e-2 1.64e-2 6.55e-3 2.05e-3 8.66e-4 3.71e-4 1.49e-4 5.45e-5 3.96e-5 4.95e-6];
snr=0:0.2:2.8;
% define T_MinMax_DECODE 5（不支持）

%% start %%%%%%%%%%%%%%%%%%%%%%%% start %%%%%%%%%%%%%%%%%%%%%
% lds 160_120_6_8 
snr=0:1:7;
ber=[0.161 0.114 6.434e-2 2.238e-2 7.917e-3 2.407e-3 2.626e-4 5.814e-5];
fer=[1 1 0.98 0.806 0.417 0.144 3.891e-2 9.121e-3];
% lds 160_120_3_4
snr=0:10;
ber=[0.152 0.122 8.913e-2 6.313e-2 4.135e-2 2.248e-2 9.651e-3 4.264e-3 1.577e-3 2.852e-4 4.846e-5];
fer=[1 1 1 1 9.615e-1 8.772e-1 7.353e-1 4.673e-1 2.252e-1 4.003e-2 7.314e-3];
% lds 16_12_3_4
snr=0:10;
ber=[1.627e-1 1.316e-1 1.032e-1 6.960e-2 4.688e-2 3.595e-2 1.277e-2 5.194e-3 2.117e-3 4.106e-4 6.504e-5];
fer=[9.434e-1 8.772e-1 7.937e-1 5.682e-1 4.310e-1 3.268e-1 1.548e-1 6.812e-2 3.079e-2 5.763e-3 9.817e-4];
% lds160_120_9_12
snr=0:9;
ber=[0.4003 0.3828 0.3672 0.3386 0.3197 0.3011 0.2543 0.2046 0.1343 7.261e-2];
fer=[1 0.9804 0.9804 0.8929 0.8197 0.7813 0.6329 0.5102 0.3401 0.1969];
% plot
semilogy(0:1:7,[0.161 0.114 6.434e-2 2.238e-2 7.917e-3 2.407e-3 2.626e-4 5.814e-5],'r');
hold on;
semilogy(0:1:7,[1 1 0.98 0.806 0.417 0.144 3.891e-2 9.121e-3],'g');
grid on;
xlabel('EsNo(dB)');ylabel('BER/BLER');
title('LDS CDMA,Uncoded');

semilogy(0:10,[0.152 0.122 8.913e-2 6.313e-2 4.135e-2 2.248e-2 9.651e-3 4.264e-3 1.577e-3 2.852e-4 4.846e-5],'r*-');
semilogy(0:10,[1 1 1 1 9.615e-1 8.772e-1 7.353e-1 4.673e-1 2.252e-1 4.003e-2 7.314e-3],'g*-');

semilogy(0:10,[1.627e-1 1.316e-1 1.032e-1 6.960e-2 4.688e-2 3.595e-2 1.277e-2 5.194e-3 2.117e-3 4.106e-4 6.504e-5],'ro-');
semilogy(0:10,[9.434e-1 8.772e-1 7.937e-1 5.682e-1 4.310e-1 3.268e-1 1.548e-1 6.812e-2 3.079e-2 5.763e-3 9.817e-4],'go-');

semilogy(0:9,[0.4003 0.3828 0.3672 0.3386 0.3197 0.3011 0.2543 0.2046 0.1343 7.261e-2],'r>-');
semilogy(0:9,[1 0.9804 0.9804 0.8929 0.8197 0.7813 0.6329 0.5102 0.3401 0.1969],'g>-');
legend('lds160-120-6-8,ber','lds160-120-6-8,fer','lds160-120-3-4,ber','lds160-120-3-4,fer','lds16-12-3-4,ber','lds16-12-3-4,fer','lds160-120-9-12,ber','lds160-120-9-12,fer','Location','southwest')
hold off;
%% end %%%%%%%%%%%%%%%%%%%%%%%% end %%%%%%%%%%%%%%%%%%%%%
%% start %%%%%%%%%%%%%%%%%%%%%%%%
% lds24_12_3_6 matlab
snr=0:10;
ber=[0.1875    0.1483    0.1134    0.1250    0.0861    0.0514    0.0331    0.0145    0.0051    0.0020    0.0005];
fer=[0.9375    0.8824    0.8333    0.7317    0.6667    0.3704    0.2564    0.1389    0.0442    0.0166    0.0038];

% lds24_12_2_4
snr=0:12;
ber=[0.2212 0.1899 0.1691 0.1352 0.1049 8.150e-2 5.114e-2 3.314e-2 1.768e-2 5.262e-3 1.512e-3 4.938e-4 5.019e-5];
fer=[0.9615 0.9615 0.9615 0.9434 0.8929 0.7353 0.5682 0.3937 0.2101 7.342e-2 2.388e-2 6.511e-3 9.266e-4];
semilogy(snr(1:11),ber(1:11),'r-.');
hold on;
semilogy(snr(1:11),fer(1:11),'g-.');
grid on;
xlabel('EsNo(dB)');ylabel('BER/FER');
title('LDS CDMA,Uncoded')

% lds24_12_3_6
snr=0:10;
ber=[1.899e-1 1.767e-1 1.597e-1 1.194e-1 9.253e-2 5.556e-2 2.930e-2 1.689e-2 3.917e-3 1.638e-3 2.690e-4];
fer=[9.615e-1 9.259e-1 9.259e-1 8.333e-1 6.494e-1 4.762e-1 2.747e-1 1.661e-1 5e-2 1.986e-2 3.398e-3];
semilogy(snr+1.76,ber,'ro-');
semilogy(snr+1.76,fer,'go-');

% lds24_12_4_8
snr=0:10;
ber=[0.2557 0.2626 0.2639 0.2571 0.2212 0.1783 0.1461 0.1201 6.980e-2 3.255e-2  2.615e-2];
fer=[0.9804 0.9434 0.9259 0.8475 0.7692 0.6667 0.5495 0.4167 0.2577 0.1385 8.865e-2];
semilogy(snr+3,ber,'r*-');
semilogy(snr+3,fer,'g*-');

% lds240_120_4_8
snr=0:9;
ber=[0.1786 0.1589 0.1325 0.1009 6.192e-2 2.579e-2 5.815e-3 9.653e-4 2.064e-4 3.102e-5];
fer=[1 1 1 1 1 0.9434 0.5495 0.1931 4.270e-2 7.023e-3];
semilogy(snr+3,ber,'r>-');
semilogy(snr+3,fer,'g>-');

% lds240_120_3_6
snr=0:10;
ber=[0.1838 0.1621 0.138 0.1068 7.3e-2 3.95e-2 1.437e-2 6e-3 1.436e-3 2.913e-4 6.322e-5];
fer=[1 1 1 1 1 1 0.8621 0.6667 0.2427 6.242e-2 1.459e-2];
semilogy(snr+1.5,ber,'r');
semilogy(snr+1.5,fer,'g');

% lds240_120_2_4
snr=0:10;
ber=[0.2033 0.1784 0.1545 0.1308 0.1032 7.517e-2 5.042e-2 3.058e-2 1.304e-2 4.214e-3 1.485e-3];
fer=[1 1 1 1 1 1 1 1 0.9259 0.5682 0.2315];
semilogy(snr,ber,'r<-');
semilogy(snr,fer,'g<-');

% lds24_12_1_2
snr=0:10;
ber=[0.1010 7.485e-2 3.961e-2 2.299e-2 2.556e-2 8.391e-3 2.823e-3 9.185e-4 2.348e-4 4.285e-5 5.544e-6];
fer=[0.9615 0.9259 0.6173 0.4310 0.3012 0.1736 6.274e-2 2.120e-2 5.218e-3 9.183e-4 1.147e-4];
semilogy(snr,ber,'rd-.');
semilogy(snr,fer,'gd-.');

legend('lds24-12-2-4,ber','lds24-12-2-4,fer','lds24-12-3-6,ber','lds24-12-3-6,fer','lds24-12-4-8,ber','lds24-12-4-8,fer','lds240-120-4-8,ber','lds240-120-4-8,fer','lds240-120-3-6,ber','lds240-120-3-6,fer','lds240-120-2-4,ber','lds240-120-2-4,fer','lds24-12-1-2,ber','lds24-12-1-2,fer','Location','southwest');
hold off;
%% end %%%%%%%%%%%%%%%%%%%%%%%%%%
%% scma %%%%%%%%
% 华为scma矩阵
snr=11:17;
EbNo=snr-10*log10(12/4);
fer=[0.0737    0.0488    0.0192    0.0062    0.0035    0.0007    0.0005];
ber=[0.0360    0.0192    0.0101    0.0040    0.0021    0.0005    0.0004];
semilogy(EbNo,fer,'r-');
grid on;
hold on;
semilogy(EbNo,ber,'g-');
xlabel('EbNo(dB)');ylabel('FER/BER')
% SCMA Codebook Design Based on Constellation Rotation 新码本构造方法
snr=11:17;
EbNo=snr-10*log10(12/4);
fer=[0.1389    0.0875    0.0383    0.0125    0.0051    0.0018    0.0004];
ber=[0.0903    0.0593    0.0266    0.0069    0.0035    0.0011    0.0003];
semilogy(EbNo,fer,'r>-');
semilogy(EbNo,ber,'g>-');
% qpsk ldscdma12*16
snr=11:15;
EbNo=snr-10*log10(16*2/12);
fer=[0.3165 0.1650 5.5443e-2 1.868e-2 4.755e-3];
ber=[5.459e-2 3.403e-2 9.770e-3 3.701e-3 8.381e-4];
semilogy(EbNo,fer,'r*-');
semilogy(EbNo,ber,'g*-');
hold off;
legend('fer,华为码本','ber，华为码本','fer，论文码本','ber，论文码本','fer，LdsQpsk','ber，LdsQpsk');
    
