clear;
%% reference: An Optimized Design of SCMA Codebook Based on Star-QAM Signaling Constellations
K=4;
J=6;
M=4;
F=[1 1 0 0;1 0 1 0;1 0 0 1;0 1 1 0;0 1 0 1;0 0 1 1;]';
R1=1;
theta1=pi/6;
theta2=2*theta1;
theta3=3*theta1;
alpha0=3;
beta=1/0.63;
R2=R1*beta;
MC=[alpha0*R1,R1,-R1,-alpha0*R1;
    -R2,alpha0*R2,-alpha0*R2,R2];
delta1=[exp(1i*theta1),0;0,exp(1i*theta2)];
delta2=[1,0;0,1];
delta3=[0,1;1,0]*[exp(1i*theta1),0;0,exp(1i*theta3)];
delta4=[1,0;0,exp(1i*theta2)];
delta5=[0,1;1,0];
delta6=[1,0;0,exp(1i*theta3)];
V1=[1 0;0 1;0 0;0 0];
V2=[1 0;0 0;0 1;0 0];
V3=[1 0;0 0;0 0;0 1];
V4=[0 0;1 0;0 1;0 0];
V5=[0 0;1 0;0 0;0 1];
V6=[0 0;0 0;1 0;0 1];
C1=V1*delta1*MC;
C2=V2*delta2*MC;
C3=V3*delta3*MC;
C4=V4*delta4*MC;
C5=V5*delta5*MC;
C6=V6*delta6*MC;
S=zeros(K,J,M);
S(:,1,:)=C1;
S(:,2,:)=C2;
S(:,3,:)=C3;
S(:,4,:)=C4;
S(:,5,:)=C5;
S(:,6,:)=C6;
S=S/sqrt(26.32);
save Sv2.mat S F;
